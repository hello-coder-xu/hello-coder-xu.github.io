<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test</title>
    <style>
        #btn {
            display: block;
            margin: 0 auto;
            font-size: 24px;
        }
    </style>
</head>


<body>
    <button onclick="isAppInstalled()">打开app2</button>
    <script>
        function openApp() {
            // todo: 你的其他逻辑
            window.location.href = 'https://hello-coder-xu.github.io/yinxu';
            console.log('打开App 点击事件')
            // setTimeout(() => {
            //     // 如果成功打开了应用，则说明应用已安装
            //     if (document.hidden || document.webkitHidden) {
            //         // 应用已安装
            //         window.close()
            //     } else {
            //         // 应用未安装

            //     }
            // }, 2000)
        }


        function isAppInstalled(callback) {
            var iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.src = 'https://hello-coder-xu.github.io/yinxu?region=1';
            document.body.appendChild(iframe);
            var start = new Date().getTime();
            var timeout = 2000; // 2秒超时
            var interval = setInterval(function () {
                if (new Date().getTime() - start > timeout) {
                    clearInterval(interval);
                    document.body.removeChild(iframe);
                    callback(false);
                }
            }, 100);
            window.addEventListener('blur', function () {
                clearInterval(interval);
                document.body.removeChild(iframe);
                callback(true);
            });
        }

        // 使用示例
        isAppInstalled(function (installed) {
            if (installed) {
                console.log('WhatsApp已安装');
            } else {
                console.log('WhatsApp未安装');
            }
        });

    </script>
</body>

</html>